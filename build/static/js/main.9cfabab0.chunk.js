(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n={uqBasedata:"bruce/mi",appIcon:"http://101.200.46.56/imgs/Bear-icon.png",miApiHost:"http://106.14.213.254/",miApiHostDebug:"http://localhost:6010/",isDevelopment:!1}},46:function(e,t,i){e.exports=i.p+"static/media/logo.5d5d9eef.svg"},49:function(e,t,i){e.exports=i(82)},56:function(e,t,i){},80:function(e,t,i){},82:function(e,t,i){"use strict";i.r(t);var n=i(0),o=i(25),r=(i(54),i(12)),s=(i(56),i(14)),a=i(45),l=i.n(a);const c=()=>{let e=l()({loader:()=>i.e(2).then(i.bind(null,85)),loading:s.i});return n.createElement(e,null)},d=e=>!0===e?"text-primary":"text-muted";var h=i(46),u=i.n(h);class p extends s.s{render(){n.createElement(s.d,{name:"globe"}),n.createElement("div",null,"\u767b\u5f55");let e=n.createElement("img",{className:"m-1",src:u.a,alt:"logo",style:{height:"3rem",width:"3rem"}});return n.createElement(s.g,{className:"mb-3 align-items-center bg-white",left:e,right:void 0},n.createElement("div",{className:""},this.controller.renderSearchHeader("md")))}}class m extends s.s{constructor(){super(...arguments),this.onSearch=(e=>r.a(this,void 0,void 0,function*(){}))}render(e){return n.createElement(s.o,{className:"px-1 w-100",size:e,onSearch:this.onSearch,placeholder:"\u529f\u80fd..."})}}var v=i(38);const g=5;class f extends s.s{constructor(){super(...arguments),this.renderSection=((e,t)=>n.createElement("section",null,n.createElement("h4",null,e.title,n.createElement("small",{className:"text-muted"},e.subtitle)),n.createElement("p",null,e.content))),this.page=Object(v.a)(()=>{let{openMetaView:e,onPage:t}=this.controller,i=(this.controller.renderSiteHeader(),n.createElement(n.Fragment,null));return this.controller.isLogined&&this.controller.user.id===g&&(i=n.createElement("button",{type:"button",className:"btn w-100",onClick:e},"view")),n.createElement(s.l,{header:"ddddd",onScrollBottom:t,headerClassName:"bg-primary py-1 px-3"},n.createElement(this.content,null))}),this.content=Object(v.a)(()=>{let{renderSiteHeader:e,PageItems:t}=this.controller;return n.createElement(n.Fragment,null,n.createElement(s.h,{items:t.items,item:{render:this.renderRow,onClick:this.clickRow,key:this.rowKey},before:"\u641c\u7d22 \u8d44\u6599"}))}),this.renderRow=((e,t)=>n.createElement(this.rowContent,Object.assign({},e))),this.rowContent=(e=>{let{id:t,name:i,code:o,symbol:r}=e;return n.createElement(s.g,{className:"px-3 py-2",left:i,right:t},n.createElement("div",{className:"px-3"}," ",r))}),this.rowKey=(e=>{let{id:t}=e;return t}),this.clickRow=(e=>{this.callOnSelected(e)})}open(e){return r.a(this,void 0,void 0,function*(){})}render(e){return n.createElement(this.page,null)}onSelected(e){return r.a(this,void 0,void 0,function*(){})}callOnSelected(e){void 0!==this.onSelected?this.onSelected(e):alert("onSelect is undefined")}}class w extends s.m{constructor(e){super(!0),this.cHome=e,this.pageSize=30,this.firstSize=30}load(e,t,i){return r.a(this,void 0,void 0,function*(){let e=yield this.cHome.cApp.miApi.page("q_stocksquery",[],t,i);return!1===Array.isArray(e)?[]:e})}setPageStart(e){this.pageStart=void 0===e?0:e.id}}class y extends s.c{constructor(e,t){super(t),this.onPage=(()=>{this.PageItems.more()}),this.renderSiteHeader=(()=>this.renderView(p)),this.renderSearchHeader=(e=>this.renderView(m,e)),this.renderHome=(()=>this.renderView(f)),this.openMetaView=(()=>{}),this.tab=(()=>n.createElement(this.renderHome,null)),this.buildPageItems(),this.cApp=e,this.vHome=new f(this)}buildPageItems(){return this.PageItems=new w(this)}searchMain(e){return r.a(this,void 0,void 0,function*(){void 0===this.PageItems&&(this.PageItems=this.buildPageItems()),void 0!==e&&(yield this.PageItems.first(e))})}internalStart(e){return r.a(this,void 0,void 0,function*(){})}}var b=i(29),E=i(17),S=i.n(E);class k{constructor(e,t,i,n){this.startWait=(()=>{void 0!==this.ui&&this.ui.startWait()}),this.endWait=((e,t)=>{void 0!==this.ui&&this.ui.endWait(),void 0!==t&&t("\u8bbf\u95eewebapi\u8d85\u65f6 "+e)}),this.showError=(e=>r.a(this,void 0,void 0,function*(){void 0!==this.ui&&(yield this.ui.showError(e))})),this.isCenter=e,this.hostUrl=t,this.apiToken=i,this.ui=n,this.timeout=!0===b.a.isDevelopment?5e5:5e3}used(){this.post("",{})}get(e,t){return r.a(this,void 0,void 0,function*(){if(t){let i=Object.keys(t);if(i.length>0){let n="?";for(let o of i){void 0!==t[o]&&(e+=n+o+"="+t[o],n="&")}}}let i=this.buildOptions();return i.method="GET",yield this.innerFetch(e,i)})}post(e,t){return r.a(this,void 0,void 0,function*(){let i=this.buildOptions();return i.method="POST",i.body=JSON.stringify(t),yield this.innerFetch(e,i)})}put(e,t){return r.a(this,void 0,void 0,function*(){let i=this.buildOptions();return i.method="PUT",i.body=JSON.stringify(t),yield this.innerFetch(e,i)})}delete(e,t){return r.a(this,void 0,void 0,function*(){let i=this.buildOptions();return i.method="DELETE",i.body=JSON.stringify(t),yield this.innerFetch(e,i)})}fetch(e,t,i,n){return r.a(this,void 0,void 0,function*(){let o=this;this.startWait();let a=e;function l(e){return{channel:o,url:a,options:t,resolve:i,reject:n,error:e}}try{console.log("%s %s",t.method,a);let d=setTimeout(()=>o.endWait(e,n),this.timeout),h=yield fetch(encodeURI(a),t);if(!1===h.ok)throw clearTimeout(d),o.endWait(),console.log("call error %s",h.statusText),h.statusText;let u=h.headers.get("content-type");if(u&&u.indexOf("json")>=0)return h.json().then(e=>r.a(this,void 0,void 0,function*(){if(clearTimeout(d),o.endWait(),!0===e.ok)return i(e.res);void 0===e.error?yield o.showError(l("not valid tonva json")):(yield o.showError(l(e.error)),n(e.error))})).catch(e=>r.a(this,void 0,void 0,function*(){yield o.showError(l(e.message))}));{let e=yield h.text();clearTimeout(d),o.endWait(),i(e)}}catch(c){if("string"===typeof c&&!0===c.toLowerCase().startsWith("unauthorized"))return void s.t.logout();yield this.showError(l(c.message))}})}innerFetch(e,t){return r.a(this,void 0,void 0,function*(){let i=this.hostUrl+e;return yield new Promise((e,n)=>r.a(this,void 0,void 0,function*(){yield this.fetch(i,t,e,n)}))})}callFetch(e,t,i){return r.a(this,void 0,void 0,function*(){let n=this.buildOptions();return n.method=t,n.body=i,yield new Promise((t,i)=>r.a(this,void 0,void 0,function*(){yield this.fetch(e,n,t,i)}))})}buildOptions(){let{language:e,culture:t}=s.t,i=new Headers;i.append("Content-Type","application/json;charset=UTF-8");let n=e;return t&&(n+="-"+t),i.append("Accept-Language",n),this.apiToken&&i.append("Authorization",this.apiToken),{headers:i}}}class H{startWait(){s.t.startWait()}endWait(){s.t.endWait()}showError(e){return r.a(this,void 0,void 0,function*(){s.t.endWait(),yield s.t.onError(e)})}}class O{constructor(e,t){this.path=e||"",this.showWaiting=t}call(e,t,i){return r.a(this,void 0,void 0,function*(){let n=yield this.getHttpChannel();return yield n.callFetch(e,t,i)})}get(e,t){return r.a(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.get(this.path+e,t)})}post(e,t){return r.a(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.post(this.path+e,t)})}put(e,t){return r.a(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.put(this.path+e,t)})}delete(e,t){return r.a(this,void 0,void 0,function*(){let i=yield this.getHttpChannel();return yield i.delete(this.path+e,t)})}}let P={},W={};class x extends O{constructor(e,t,i,n,o){super(t,o),this.showWaiting=o,this.apiName=i,this.token=n,this.url=e}getHttpChannel(){return r.a(this,void 0,void 0,function*(){let e,t;!0===this.showWaiting||void 0===this.showWaiting?(e=P,t=new H):e=W;let i=e[this.apiName];return void 0!==i?i:(i=new k(!1,this.url,this.token,t),e[this.apiName]=i)})}query(e,t){return r.a(this,void 0,void 0,function*(){let i={call:e,params:t};return yield this.post("sql/call",i)})}page(e,t,i,n){return r.a(this,void 0,void 0,function*(){let o;switch(typeof t){case"undefined":o=[];break;default:o=S.a.clone(t)}o.push(i),o.push(n);let r={call:e,params:o};return yield this.post("sql/call",r)})}}var T={appName:"bruce/mi",CApp:class extends s.a{internalStart(){return r.a(this,void 0,void 0,function*(){this.isLogined,s.t;let e=this.user.token,t=b.a.isDevelopment?b.a.miApiHostDebug:b.a.miApiHost;this.miApi=new x(t,"fsjs/","miapi",e,!1),this.cHome=new y(this,void 0),Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_CENTER_HOST:"101.200.46.56",REACT_APP_MIDATA_HOST:"106.14.213.254"}),this.cHome.searchMain(""),this.showMain()})}showMain(e){this.openVPage(this.VAppMain,e)}showOneVPage(e,t){return r.a(this,void 0,void 0,function*(){yield new e(this).open(t)})}onDispose(){}},main:class extends s.r{constructor(){super(...arguments),this.render=(e=>{let{cHome:t}=this.controller,i=[{name:"home",label:"\u9996\u9875",icon:"home",content:t.tab,notify:void 0},{name:"me",label:"\u6211\u7684",icon:"user",content:c}].map(e=>{let{name:t,label:i,icon:n,content:o,notify:r}=e;return{name:t,caption:e=>Object(s.p)(i,n,d(e)),content:o,notify:r}});return n.createElement(s.l,{header:!1},n.createElement(s.q,{tabs:i}))})}open(e){return r.a(this,void 0,void 0,function*(){this.openPage(this.render)})}},uqs:{"bruce/mi":{}}};var C=class extends n.Component{constructor(){super(...arguments),this.onLogined=(()=>r.a(this,void 0,void 0,function*(){yield Object(s.u)(T)}))}render(){return n.createElement(s.k,{onLogined:this.onLogined})}};i(80);const A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function N(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=(()=>{const t=e.installing;t&&(t.onstatechange=(()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}))})}).catch(e=>{console.error("Error during service worker registration:",e)})}o.render(n.createElement(C,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="./service-worker.js";A?(function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):N(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):N(e)})}}()}},[[49,5,3]]]);
//# sourceMappingURL=main.9cfabab0.chunk.js.map